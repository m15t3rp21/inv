@using DNRPS.POIMS.CommonResources;
@using DNRPS.POIMS.Web.Models;
@model DNRPS.POIMS.CommonResources.Models.ManualInputModel

@{
    ViewBag.Title = "InputConfiguration";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm(null, null, FormMethod.Post))
{
    @(Html.Kendo().PanelBar()
    .Name("panelbar")
    .ExpandMode(PanelBarExpandMode.Single)
    .Items(panelbar =>
    {
        panelbar.Add().Text(Names.InputConfiguration)
            .Expanded(true)
            .Content(@<div style="padding: 10px;">
                <div class="k-grid k-widget">
                    @(Html.Kendo().Grid<DNRPS.POIMS.CommonResources.Models.ManualInputModel>()
                        .Name("grid")
                        .Columns(columns =>
                        {
                            //TODO: Update the UoM
                            columns.Bound(c => c.TankName).ClientTemplate(
                                    @"<div class='tagType-image'
                                        style='background-image: url(../../content/web/Customers/#:data.CustomerID#.jpg);'></div>
                                    <div class='tank-name'>#: TagName #</div>").Title(Names.TankName)
                              .Width(240);
                            columns.Bound(c => c.ComputationMode).Title(Names.ComputationMode);
                            columns.Bound(c => c.LevelSource).Title(Names.LevelSource);
                            columns.Bound(c => c.TemperatureSource).Title(Names.TemperatureSource);
                        })
                        ////.HtmlAttributes(new { style = "height: 550px;" })
                        .ToolBar(tools => tools.Excel())
                        .Scrollable()
                        ////.Groupable()
                        .Sortable()
                        .Excel(excel => excel
                            .FileName("TagsExport.xlsx")
                            .Filterable(true)
                            .ProxyURL(Url.Action("Excel_Export_Save", "Grid"))
                        )
                        .Pageable(pageable => pageable
                        .Refresh(true)
                        .PageSizes(true)
                        .ButtonCount(5))
                        .ToolBar(toolbar =>
                        {
                            toolbar.Save();
                        })
                        .Editable(editable => editable.Mode(GridEditMode.InCell))
                        .DataSource(dataSource => dataSource
                            .Ajax()
                            .Batch(true)
                            .Model(model => model.Id(p => p.TankKey))
                            .ServerOperation(false)
                            .Read(read => read.Action("TanksConfigurationData_Read", "ManualInput"))
                            .Update("Editing_Update", "ManualInput")
                            .PageSize(10)
                        )
                    )

                    <style>
                        .tagType-image {
                            display: inline-block;
                            width: 32px;
                            height: 32px;
                            border-radius: 50%;
                            background-size: 32px 35px;
                            background-position: center center;
                            vertical-align: middle;
                            line-height: 32px;
                            box-shadow: inset 0 0 1px #999, inset 0 0 10px rgba(0,0,0,.2);
                            margin-left: 5px;
                        }

                        .tank-name {
                            display: inline-block;
                            vertical-align: middle;
                            line-height: 32px;
                            padding-left: 3px;
                        }
                    </style>

                </div>
            </div>);
    })
    )


    <style>
        #panelbar {
            /*max-width: 400px;*/
            margin: 0 auto;
        }

        .box:after {
            content: ".";
            display: block;
            height: 0;
            line-height: 0;
            clear: both;
            visibility: hidden;
        }

        .box h2 {
            font-size: 1.4em;
            font-weight: normal;
            padding-top: 5px;
        }

        .box p {
            margin: 0;
        }

        .box img {
            float: left;
            margin: 5px 15px 5px 5px;
            border: 1px solid #ccc;
            border-radius: 50%;
        }

        .tagType-image {
            display: inline-block;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-size: 32px 35px;
            background-position: center center;
            vertical-align: middle;
            line-height: 32px;
            box-shadow: inset 0 0 1px #999, inset 0 0 10px rgba(0,0,0,.2);
            margin-left: 5px;
        }

        .tank-name {
            display: inline-block;
            vertical-align: middle;
            line-height: 32px;
            padding-left: 3px;
        }
    </style>
}


